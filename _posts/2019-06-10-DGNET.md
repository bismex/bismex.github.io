---
layout: post
title: "[2019 CVPR] Joint Discriminative and Generative Learning for Person Re-identification (*Incomplete*)"
date: 2019-06-10 15:00:00
tags: CV re-id supervised gan 
---

<!--more-->

---

**Table of content** (*full-version*)
[[paper]](https://arxiv.org/pdf/1904.07223.pdf) 
{: class="table-of-content"}
* TOC
{:toc}

---

## Summary

- Joint learning (end-to-end): data generation(generative module) + re-id learning(discriminative module) (처음)
- Generative module에서 appearance/structure 구분하여 인코딩, discriminative module에서 appearance code를 generative module과 공유

---

## Motivation

- Cross camera 사이의 intra class variation 문제를 해결하기 위해 data augmentation을 위한 여러가지 generative pipeline 들이 존재
- Generative pipeline은 보통 discriminative re-id learning 단계와 상대적으로 분리
- 이 논문에서는 생성된 데이터들을 더 잘 이용함으로써 학습된 re-id embedding을 향상시키기 위해서 re-id learning과 data generation을 동시에 학습하는 end-to-end 구조를 제안한다. (처음)
- Unconditional GAN과 다른점: more controllable generation with better quality
- Pose-guided GAN과 다른점: 가지고 있는 데이터셋의 pose-variation을 이용하기에 추가적인 보조 데이터(3d pose)가 필요하지 않음

---

## Architecture

- Generative module
  - 기본 구조
    - 사람 영상을 appearance/structure code로 분리하여 인코딩
    - appearance 혹은 structure code를 변경함으로써 고품질의 cross-id 영상을 발생시킬 수 있다.
    - 이는 appearance encoder에 온라인 피드백되며 discriminative module을 향상시킬 수 있다. 
  - Self-identity generation
    - 목적: To regularize generator
    - Self reconstruction task: $$L^{img}_{recon}$$
    - 
    - 같은 사람 같은 shape주고 identity loss
    - 다른 appearance라도 같게끔 (shape동일) 같은 id이긴 해야 하고
  - Cross-identity generation
    - 목적: 생성된 영상을 제어가능하게 하고, 실제 데이터 분포에 부합하게 하기 위해서
    - a와 s에 대한 cycle GAN
    - id loss도 있고
    
<br/>
![picture]({{ '/assets/images/DGNET01.png' | relative_url }})
{: style="width: 70%;" class="center"}
<span style="color: #e01f1f;">***Fig. 1. Generative module***</span>
    
    
- Discriminative module
  - 아래 두개는 어느정도 수렴한다음에 학습
  - appearance code를 generative module과 공유
  - Primary feature learning
    - appearance쪽에 강한 feature를 learning
    - inter class variation 키우기 위해서 dynamic soft labeling을 한 teacher student type supervision을 채택 
    - baseline CNN (teacher)와 비슷하게??
  - Fine-grained feature mining
    - appearance invariant, structure를 중점적으로 학습
    - a+s에 의한 영상을 s ID주고 학습 (id loss를 쓴다).


    
<br/>
![picture]({{ '/assets/images/DGNET02.png' | relative_url }})
{: style="width: 50%;" class="center"}
<span style="color: #e01f1f;">***Fig. 2. Discriminative module***</span>
      
<br/>
![picture]({{ '/assets/images/DGNET03.png' | relative_url }})
{: style="width: 100%;" class="center"}
<span style="color: #e01f1f;">***Fig. 3. 전체 프레임워크***</span>
    

---

## Experimental results

- Image generation

<br/>
![picture]({{ '/assets/images/DGNET04.png' | relative_url }})
{: style="width: 100%;" class="center"}
<span style="color: #e01f1f;">***Fig. 4. 다른 방법들과 image generation 결과 비교***</span>
    
    
<br/>
![picture]({{ '/assets/images/DGNET05.png' | relative_url }})
{: style="width: 100%;" class="center"}
<span style="color: #e01f1f;">***Fig. 5. Appearance와 structure 융합 예시***</span>
    
- Ablation study
    
<br/>
![picture]({{ '/assets/images/DGNET06.png' | relative_url }})
{: style="width: 60%;" class="center"}
<span style="color: #e01f1f;">***Fig. 6. Ablation study (image generation)***</span>

    
<br/>
![picture]({{ '/assets/images/DGNET07.png' | relative_url }})
{: style="width: 60%;" class="center"}
<span style="color: #e01f1f;">***Fig. 7. Ablation study (discriminative module)***</span>

- Performance

    
<br/>
![picture]({{ '/assets/images/DGNET08.png' | relative_url }})
{: style="width: 60%;" class="center"}
<span style="color: #e01f1f;">***Fig. 8. Re-ID performance (Market-1501, DukeMTMC-reID)***</span>
    
<br/>
![picture]({{ '/assets/images/DGNET09.png' | relative_url }})
{: style="width: 60%;" class="center"}
<span style="color: #e01f1f;">***Fig. 9. Re-ID performance (MSMT17)***</span>
    
    
- Failure case
  - 단색옷이 많아서 텍스쳐 로고 잘 반영이 안된다.
  
  
<br/>
![picture]({{ '/assets/images/DGNET10.png' | relative_url }})
{: style="width: 60%;" class="center"}
<span style="color: #e01f1f;">***Fig. 10. Failure case***</span>

---

## Comments

- 색만 입힌 느낌이 난다. 텍스쳐가 잘 안잡히는 느낌

---

## References

[1] Zheng, Zhedong, et al. "Joint discriminative and generative learning for person re-identification." arXiv preprint arXiv:1904.07223 (2019).
